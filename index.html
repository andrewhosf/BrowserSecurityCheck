<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visitor Information</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .info-card {
            background-color: #f8f9fa;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .info-card h2 {
            margin-top: 0;
            color: #007bff;
            font-size: 1.2em;
        }
        .info-card p {
            margin: 10px 0;
            color: #555;
        }
        .loading {
            color: #666;
            font-style: italic;
        }
        .security-status {
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
            margin-left: 10px;
        }
        .status-safe {
            background-color: #d4edda;
            color: #155724;
        }
        .status-warning {
            background-color: #fff3cd;
            color: #856404;
        }
        .status-danger {
            background-color: #f8d7da;
            color: #721c24;
        }
        .security-details {
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
        }
        .vulnerability-list {
            list-style: none;
            padding: 0;
            margin: 10px 0;
        }
        .vulnerability-item {
            padding: 8px;
            margin: 5px 0;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .severity-high {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
        }
        .severity-medium {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
        }
        .severity-low {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
        }
        .scan-progress {
            width: 100%;
            height: 4px;
            background-color: #e9ecef;
            border-radius: 2px;
            margin: 10px 0;
        }
        .scan-progress-bar {
            height: 100%;
            background-color: #007bff;
            border-radius: 2px;
            transition: width 0.3s ease;
        }
        .compliance-section {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .compliance-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .compliance-icon {
            margin-right: 10px;
            font-size: 1.2em;
        }
        .compliance-status {
            margin-left: auto;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9em;
        }
        .compliance-details {
            margin-left: 30px;
            font-size: 0.9em;
        }
        .requirement-item {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #ddd;
        }
        .requirement-met {
            border-left-color: #28a745;
        }
        .requirement-failed {
            border-left-color: #dc3545;
        }
        .requirement-warning {
            border-left-color: #ffc107;
        }
        .remediation-guide {
            margin-top: 10px;
            padding: 10px;
            background-color: #e9ecef;
            border-radius: 4px;
            font-size: 0.9em;
        }
        .remediation-guide h5 {
            margin: 0 0 5px 0;
            color: #495057;
        }
        .remediation-steps {
            margin: 0;
            padding-left: 20px;
        }
        .remediation-steps li {
            margin: 3px 0;
        }
        .documentation-links {
            margin-top: 5px;
            font-size: 0.85em;
        }
        .documentation-links a {
            color: #0066cc;
            text-decoration: none;
        }
        .documentation-links a:hover {
            text-decoration: underline;
        }
        .compliance-reference {
            font-size: 0.8em;
            color: #6c757d;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Visitor Information</h1>
        
        <div class="info-card">
            <h2>IP Address</h2>
            <p id="ip-address" class="loading">Loading...</p>
        </div>

        <div class="info-card">
            <h2>Browser Information</h2>
            <p id="browser-info" class="loading">Loading...</p>
        </div>

        <div class="info-card">
            <h2>Geolocation</h2>
            <p id="geolocation" class="loading">Loading...</p>
        </div>

        <div class="info-card">
            <h2>Security Scan</h2>
            <p id="security-scan" class="loading">Loading security scan...</p>
        </div>
    </div>

    <script>
        // Function to get IP address
        async function getIPAddress() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                document.getElementById('ip-address').textContent = data.ip;
            } catch (error) {
                document.getElementById('ip-address').textContent = 'Unable to fetch IP address';
            }
        }

        // Function to get browser information
        function getBrowserInfo() {
            const userAgent = navigator.userAgent;
            const browserInfo = {
                userAgent: userAgent,
                language: navigator.language,
                platform: navigator.platform,
                screenResolution: `${window.screen.width}x${window.screen.height}`
            };
            
            document.getElementById('browser-info').innerHTML = `
                User Agent: ${browserInfo.userAgent}<br>
                Language: ${browserInfo.language}<br>
                Platform: ${browserInfo.platform}<br>
                Screen Resolution: ${browserInfo.screenResolution}
            `;
        }

        // Function to get geolocation
        function getGeolocation() {
            if ("geolocation" in navigator) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        document.getElementById('geolocation').innerHTML = `
                            Latitude: ${position.coords.latitude}<br>
                            Longitude: ${position.coords.longitude}<br>
                            Accuracy: ${position.coords.accuracy} meters
                        `;
                    },
                    (error) => {
                        document.getElementById('geolocation').textContent = 'Geolocation access denied';
                    }
                );
            } else {
                document.getElementById('geolocation').textContent = 'Geolocation not supported';
            }
        }

        // Function to check security headers
        function checkSecurityHeaders() {
            const headers = {
                'Content-Security-Policy': 'Not Detected',
                'X-Frame-Options': 'Not Detected',
                'X-Content-Type-Options': 'Not Detected',
                'Strict-Transport-Security': 'Not Detected'
            };

            // In a real implementation, these would be checked server-side
            // This is a simulation for demonstration
            return headers;
        }

        // Enhanced browser security check
        function checkBrowserSecurity() {
            const security = {
                'WebRTC Leak': navigator.mediaDevices ? 'Potential Risk' : 'Safe',
                'Do Not Track': navigator.doNotTrack ? 'Enabled' : 'Disabled',
                'Cookies Enabled': navigator.cookieEnabled ? 'Enabled' : 'Disabled',
                'Private Browsing': window.webkitRequestFileSystem ? 'Not Detected' : 'Potentially Enabled',
                'JavaScript Enabled': 'Enabled',
                'Local Storage': window.localStorage ? 'Available' : 'Not Available',
                'Session Storage': window.sessionStorage ? 'Available' : 'Not Available',
                'IndexedDB': window.indexedDB ? 'Available' : 'Not Available',
                'WebGL': detectWebGL() ? 'Available' : 'Not Available',
                'Canvas Fingerprinting': detectCanvasFingerprinting() ? 'Vulnerable' : 'Protected',
                'Audio Fingerprinting': detectAudioFingerprinting() ? 'Vulnerable' : 'Protected',
                'Font Fingerprinting': detectFontFingerprinting() ? 'Vulnerable' : 'Protected'
            };
            return security;
        }

        // Check for WebGL support
        function detectWebGL() {
            try {
                const canvas = document.createElement('canvas');
                return !!(window.WebGLRenderingContext && 
                    (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));
            } catch (e) {
                return false;
            }
        }

        // Check for Canvas Fingerprinting vulnerability
        function detectCanvasFingerprinting() {
            try {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = "top";
                ctx.font = "14px 'Arial'";
                ctx.textBaseline = "alphabetic";
                ctx.fillStyle = "#f60";
                ctx.fillRect(125,1,62,20);
                ctx.fillStyle = "#069";
                ctx.fillText("Hello, world!", 2, 15);
                ctx.fillStyle = "rgba(102, 204, 0, 0.7)";
                ctx.fillText("Hello, world!", 4, 17);
                return true;
            } catch (e) {
                return false;
            }
        }

        // Check for Audio Fingerprinting vulnerability
        function detectAudioFingerprinting() {
            try {
                return !!(window.AudioContext || window.webkitAudioContext);
            } catch (e) {
                return false;
            }
        }

        // Check for Font Fingerprinting vulnerability
        function detectFontFingerprinting() {
            return 'fonts' in document;
        }

        // Enhanced network security check
        function checkNetworkSecurity() {
            const security = {
                'Connection Type': navigator.connection ? navigator.connection.effectiveType : 'Unknown',
                'Downlink': navigator.connection ? `${navigator.connection.downlink} Mbps` : 'Unknown',
                'RTT': navigator.connection ? `${navigator.connection.rtt} ms` : 'Unknown',
                'Save Data': navigator.connection ? (navigator.connection.saveData ? 'Enabled' : 'Disabled') : 'Unknown',
                'Protocol': window.location.protocol,
                'Mixed Content': detectMixedContent() ? 'Detected' : 'Not Detected',
                'DNS Leak': 'Not Detected', // Would require actual DNS leak test
                'WebRTC Leak': detectWebRTCLeak() ? 'Detected' : 'Not Detected'
            };
            return security;
        }

        // Check for mixed content
        function detectMixedContent() {
            if (window.location.protocol === 'https:') {
                const images = document.getElementsByTagName('img');
                for (let img of images) {
                    if (img.src.startsWith('http:')) {
                        return true;
                    }
                }
            }
            return false;
        }

        // Check for WebRTC leaks
        function detectWebRTCLeak() {
            return !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia);
        }

        // Enhanced privacy check
        function checkPrivacy() {
            const privacy = {
                'Third-Party Cookies': detectThirdPartyCookies() ? 'Enabled' : 'Disabled',
                'Tracking Protection': detectTrackingProtection() ? 'Enabled' : 'Disabled',
                'Ad Blockers': detectAdBlockers() ? 'Detected' : 'Not Detected',
                'Social Media Trackers': detectSocialTrackers() ? 'Detected' : 'Not Detected',
                'Analytics Trackers': detectAnalytics() ? 'Detected' : 'Not Detected'
            };
            return privacy;
        }

        // Check for third-party cookies
        function detectThirdPartyCookies() {
            return navigator.cookieEnabled;
        }

        // Check for tracking protection
        function detectTrackingProtection() {
            return navigator.doNotTrack === "1" || navigator.doNotTrack === "yes";
        }

        // Check for ad blockers
        function detectAdBlockers() {
            return new Promise((resolve) => {
                const testAd = document.createElement('div');
                testAd.innerHTML = '&nbsp;';
                testAd.className = 'adsbox';
                document.body.appendChild(testAd);
                window.setTimeout(() => {
                    if (testAd.offsetHeight === 0) {
                        resolve(true);
                    } else {
                        resolve(false);
                    }
                    document.body.removeChild(testAd);
                }, 100);
            });
        }

        // Check for social media trackers
        function detectSocialTrackers() {
            const socialScripts = [
                'facebook.com',
                'twitter.com',
                'linkedin.com',
                'pinterest.com'
            ];
            return socialScripts.some(domain => 
                Array.from(document.scripts).some(script => 
                    script.src.includes(domain)
                )
            );
        }

        // Check for analytics trackers
        function detectAnalytics() {
            const analyticsScripts = [
                'google-analytics.com',
                'analytics.google.com',
                'googletagmanager.com'
            ];
            return analyticsScripts.some(domain => 
                Array.from(document.scripts).some(script => 
                    script.src.includes(domain)
                )
            );
        }

        // Add remediation guides
        const remediationGuides = {
            'PCI-DSS': {
                'Firewall Configuration': {
                    steps: [
                        'Implement and maintain a firewall configuration to protect cardholder data',
                        'Restrict connections between untrusted networks and system components',
                        'Document all firewall rules and review them quarterly'
                    ],
                    docs: [
                        { name: 'PCI DSS Requirements', url: 'https://www.pcisecuritystandards.org/document_library' },
                        { name: 'Firewall Guidelines', url: 'https://www.pcisecuritystandards.org/pdfs/pci_firewall_supplement.pdf' }
                    ]
                },
                'Encryption': {
                    steps: [
                        'Implement strong encryption for transmission of cardholder data',
                        'Use TLS 1.2 or higher for all connections',
                        'Disable weak encryption protocols and ciphers'
                    ],
                    docs: [
                        { name: 'Encryption Guidelines', url: 'https://www.pcisecuritystandards.org/pdfs/pci_ssc_quick_reference_guide.pdf' }
                    ]
                }
            },
            'GDPR': {
                'Consent Management': {
                    steps: [
                        'Implement clear consent collection mechanisms',
                        'Store consent records with timestamps',
                        'Provide easy opt-out options'
                    ],
                    docs: [
                        { name: 'GDPR Consent Guidelines', url: 'https://gdpr.eu/consent/' },
                        { name: 'Article 7', url: 'https://gdpr-info.eu/art-7-gdpr/' }
                    ]
                },
                'Data Minimization': {
                    steps: [
                        'Review and document all data collection points',
                        'Implement data retention policies',
                        'Regularly audit stored data'
                    ],
                    docs: [
                        { name: 'Data Minimization Guide', url: 'https://gdpr.eu/data-minimization/' }
                    ]
                }
            },
            'HIPAA': {
                'PHI Protection': {
                    steps: [
                        'Implement encryption for PHI at rest and in transit',
                        'Establish access controls and audit logs',
                        'Regular security risk assessments'
                    ],
                    docs: [
                        { name: 'HIPAA Security Rule', url: 'https://www.hhs.gov/hipaa/for-professionals/security/index.html' }
                    ]
                }
            },
            'SOC2': {
                'System Operations': {
                    steps: [
                        'Document system operations procedures',
                        'Implement change management process',
                        'Regular system monitoring and logging'
                    ],
                    docs: [
                        { name: 'SOC 2 Guide', url: 'https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/aicpasoc2report.html' }
                    ]
                }
            },
            'ISO27001': {
                'Risk Assessment': {
                    steps: [
                        'Conduct regular risk assessments',
                        'Document risk treatment plans',
                        'Review and update risk register'
                    ],
                    docs: [
                        { name: 'ISO 27001 Controls', url: 'https://www.iso.org/isoiec-27001-information-security.html' }
                    ]
                }
            }
        };

        // Add documentation references
        const complianceDocs = {
            'PCI-DSS': {
                main: 'https://www.pcisecuritystandards.org/document_library',
                requirements: 'https://www.pcisecuritystandards.org/pdfs/pci_dss_v3-2-1.pdf',
                quickGuide: 'https://www.pcisecuritystandards.org/pdfs/pci_ssc_quick_reference_guide.pdf'
            },
            'GDPR': {
                main: 'https://gdpr.eu/',
                text: 'https://gdpr-info.eu/',
                guidelines: 'https://ec.europa.eu/info/law/law-topic/data-protection_en'
            },
            'HIPAA': {
                main: 'https://www.hhs.gov/hipaa/index.html',
                security: 'https://www.hhs.gov/hipaa/for-professionals/security/index.html',
                privacy: 'https://www.hhs.gov/hipaa/for-professionals/privacy/index.html'
            },
            'SOC2': {
                main: 'https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/aicpasoc2report.html',
                guide: 'https://www.aicpa.org/content/dam/aicpa/interestareas/frc/assuranceadvisoryservices/downloadabledocuments/trust-services-criteria.pdf'
            },
            'ISO27001': {
                main: 'https://www.iso.org/isoiec-27001-information-security.html',
                controls: 'https://www.iso.org/isoiec-27001-information-security.html',
                guide: 'https://www.iso.org/iso-27001-information-security.html'
            }
        };

        // Compliance check functions
        function checkPCICompliance() {
            const compliance = {
                'PCI-DSS Requirements': {
                    'Network Security': {
                        'Firewall Configuration': {
                            ...checkFirewallConfig(),
                            remediation: remediationGuides['PCI-DSS']['Firewall Configuration']
                        },
                        'Default Passwords': {
                            ...checkDefaultPasswords(),
                            remediation: {
                                steps: [
                                    'Change all default passwords',
                                    'Implement password policy',
                                    'Regular password audits'
                                ],
                                docs: remediationGuides['PCI-DSS']['Firewall Configuration'].docs
                            }
                        },
                        'System Hardening': {
                            ...checkSystemHardening(),
                            remediation: {
                                steps: [
                                    'Remove unnecessary services',
                                    'Apply security patches',
                                    'Configure secure settings'
                                ],
                                docs: remediationGuides['PCI-DSS']['Firewall Configuration'].docs
                            }
                        }
                    },
                    'Data Protection': {
                        'Encryption': {
                            ...checkEncryption(),
                            remediation: remediationGuides['PCI-DSS']['Encryption']
                        },
                        'Card Data Storage': {
                            ...checkCardDataStorage(),
                            remediation: {
                                steps: [
                                    'Implement secure storage mechanisms',
                                    'Encrypt stored card data',
                                    'Regular security audits'
                                ],
                                docs: remediationGuides['PCI-DSS']['Encryption'].docs
                            }
                        },
                        'Secure Transmission': {
                            ...checkSecureTransmission(),
                            remediation: remediationGuides['PCI-DSS']['Encryption']
                        }
                    }
                }
            };
            return compliance;
        }

        function checkGDPRCompliance() {
            return {
                'GDPR Requirements': {
                    'Data Protection': {
                        'Consent Management': checkConsentManagement(),
                        'Data Minimization': checkDataMinimization(),
                        'Right to be Forgotten': checkRightToBeForgotten()
                    },
                    'Privacy Rights': {
                        'Data Portability': checkDataPortability(),
                        'Privacy Notices': checkPrivacyNotices(),
                        'Data Breach Notification': checkBreachNotification()
                    }
                }
            };
        }

        function checkHIPAACompliance() {
            return {
                'HIPAA Requirements': {
                    'Privacy Rule': {
                        'PHI Protection': checkPHIProtection(),
                        'Patient Rights': checkPatientRights(),
                        'Privacy Practices': checkPrivacyPractices()
                    },
                    'Security Rule': {
                        'Access Controls': checkAccessControls(),
                        'Audit Controls': checkAuditControls(),
                        'Transmission Security': checkTransmissionSecurity()
                    }
                }
            };
        }

        function checkSOC2Compliance() {
            return {
                'SOC 2 Requirements': {
                    'Security': {
                        'System Operations': checkSystemOperations(),
                        'Logical Access': checkLogicalAccess(),
                        'System Monitoring': checkSystemMonitoring()
                    },
                    'Availability': {
                        'Disaster Recovery': checkDisasterRecovery(),
                        'Business Continuity': checkBusinessContinuity()
                    }
                }
            };
        }

        function checkISO27001Compliance() {
            return {
                'ISO 27001 Requirements': {
                    'Information Security': {
                        'Risk Assessment': checkRiskAssessment(),
                        'Asset Management': checkAssetManagement(),
                        'Incident Management': checkIncidentManagement()
                    },
                    'Controls': {
                        'Access Control': checkISOAccessControl(),
                        'Cryptography': checkCryptography(),
                        'Operations Security': checkOperationsSecurity()
                    }
                }
            };
        }

        // Helper functions for compliance checks
        function checkFirewallConfig() {
            return {
                status: 'warning',
                details: 'Firewall configuration cannot be verified client-side'
            };
        }

        function checkDefaultPasswords() {
            return {
                status: 'warning',
                details: 'Default password check requires server-side verification'
            };
        }

        function checkSystemHardening() {
            return {
                status: 'warning',
                details: 'System hardening check requires server-side verification'
            };
        }

        function checkEncryption() {
            return {
                status: window.location.protocol === 'https:' ? 'met' : 'failed',
                details: window.location.protocol === 'https:' ? 
                    'HTTPS encryption is enabled' : 
                    'HTTPS encryption is not enabled'
            };
        }

        function checkCardDataStorage() {
            return {
                status: 'warning',
                details: 'Card data storage check requires server-side verification'
            };
        }

        function checkSecureTransmission() {
            return {
                status: window.location.protocol === 'https:' ? 'met' : 'failed',
                details: window.location.protocol === 'https:' ? 
                    'Secure transmission is enabled' : 
                    'Secure transmission is not enabled'
            };
        }

        function checkAuthentication() {
            return {
                status: 'warning',
                details: 'Authentication check requires server-side verification'
            };
        }

        function checkAuthorization() {
            return {
                status: 'warning',
                details: 'Authorization check requires server-side verification'
            };
        }

        function checkPhysicalSecurity() {
            return {
                status: 'warning',
                details: 'Physical security check requires on-site verification'
            };
        }

        // GDPR specific checks
        function checkConsentManagement() {
            return {
                status: 'warning',
                details: 'Consent management check requires server-side verification'
            };
        }

        function checkDataMinimization() {
            return {
                status: 'warning',
                details: 'Data minimization check requires server-side verification'
            };
        }

        function checkRightToBeForgotten() {
            return {
                status: 'warning',
                details: 'Right to be forgotten check requires server-side verification'
            };
        }

        function checkDataPortability() {
            return {
                status: 'warning',
                details: 'Data portability check requires server-side verification'
            };
        }

        function checkPrivacyNotices() {
            return {
                status: 'warning',
                details: 'Privacy notices check requires server-side verification'
            };
        }

        function checkBreachNotification() {
            return {
                status: 'warning',
                details: 'Breach notification check requires server-side verification'
            };
        }

        // Enhanced security scan function
        async function performSecurityScan() {
            const securityScan = document.getElementById('security-scan');
            let securityStatus = '';
            const progressBar = document.createElement('div');
            progressBar.className = 'scan-progress';
            progressBar.innerHTML = '<div class="scan-progress-bar" style="width: 0%"></div>';
            securityScan.appendChild(progressBar);

            try {
                // Simulate scanning progress
                for (let i = 0; i <= 100; i += 20) {
                    progressBar.querySelector('.scan-progress-bar').style.width = `${i}%`;
                    await new Promise(resolve => setTimeout(resolve, 200));
                }

                // Get all security information
                const headers = checkSecurityHeaders();
                const browserSecurity = checkBrowserSecurity();
                const networkSecurity = checkNetworkSecurity();
                const privacy = await checkPrivacy();
                const sslStatus = checkSSL();

                // Get compliance information
                const pciCompliance = checkPCICompliance();
                const gdprCompliance = checkGDPRCompliance();
                const hipaaCompliance = checkHIPAACompliance();
                const soc2Compliance = checkSOC2Compliance();
                const iso27001Compliance = checkISO27001Compliance();

                // Compile enhanced security report
                securityStatus = `
                    <div>
                        <strong>SSL/TLS Status:</strong> 
                        <span class="security-status ${sslStatus === 'Secure' ? 'status-safe' : 'status-danger'}">
                            ${sslStatus}
                        </span>
                    </div>
                    
                    <div class="security-details">
                        <strong>Browser Security:</strong>
                        <ul class="vulnerability-list">
                            ${Object.entries(browserSecurity).map(([key, value]) => `
                                <li class="vulnerability-item ${value.includes('Vulnerable') ? 'severity-high' : 
                                    value.includes('Risk') ? 'severity-medium' : 'severity-low'}">
                                    ${key}: ${value}
                                </li>
                            `).join('')}
                        </ul>
                    </div>

                    <div class="security-details">
                        <strong>Network Security:</strong>
                        <ul class="vulnerability-list">
                            ${Object.entries(networkSecurity).map(([key, value]) => `
                                <li class="vulnerability-item ${value.includes('Detected') ? 'severity-high' : 'severity-low'}">
                                    ${key}: ${value}
                                </li>
                            `).join('')}
                        </ul>
                    </div>

                    <div class="security-details">
                        <strong>Privacy Protection:</strong>
                        <ul class="vulnerability-list">
                            ${Object.entries(privacy).map(([key, value]) => `
                                <li class="vulnerability-item ${value.includes('Detected') ? 'severity-high' : 
                                    value.includes('Enabled') ? 'severity-medium' : 'severity-low'}">
                                    ${key}: ${value}
                                </li>
                            `).join('')}
                        </ul>
                    </div>

                    <div class="security-details">
                        <strong>Security Headers:</strong>
                        <ul class="vulnerability-list">
                            ${Object.entries(headers).map(([key, value]) => `
                                <li class="vulnerability-item ${value === 'Not Detected' ? 'severity-high' : 'severity-low'}">
                                    ${key}: ${value}
                                </li>
                            `).join('')}
                        </ul>
                    </div>

                    <div class="compliance-section">
                        <h2>Compliance Checks</h2>
                        
                        <div class="compliance-header">
                            <span class="compliance-icon">üîí</span>
                            <h3>PCI-DSS Compliance</h3>
                            <span class="compliance-status status-warning">Partial Check</span>
                        </div>
                        <div class="compliance-details">
                            ${Object.entries(pciCompliance['PCI-DSS Requirements']).map(([category, requirements]) => `
                                <h4>${category}</h4>
                                ${Object.entries(requirements).map(([req, check]) => `
                                    <div class="requirement-item requirement-${check.status}">
                                        <strong>${req}:</strong> ${check.details}
                                        ${check.remediation ? `
                                            <div class="remediation-guide">
                                                <h5>Remediation Steps:</h5>
                                                <ol class="remediation-steps">
                                                    ${check.remediation.steps.map(step => `<li>${step}</li>`).join('')}
                                                </ol>
                                                <div class="documentation-links">
                                                    ${check.remediation.docs.map(doc => 
                                                        `<a href="${doc.url}" target="_blank">${doc.name}</a><br>`
                                                    ).join('')}
                                                </div>
                                            </div>
                                        ` : ''}
                                    </div>
                                `).join('')}
                            `).join('')}
                        </div>

                        <div class="compliance-header">
                            <span class="compliance-icon">üë•</span>
                            <h3>GDPR Compliance</h3>
                            <span class="compliance-status status-warning">Partial Check</span>
                        </div>
                        <div class="compliance-details">
                            ${Object.entries(gdprCompliance['GDPR Requirements']).map(([category, requirements]) => `
                                <h4>${category}</h4>
                                ${Object.entries(requirements).map(([req, check]) => `
                                    <div class="requirement-item requirement-${check.status}">
                                        <strong>${req}:</strong> ${check.details}
                                    </div>
                                `).join('')}
                            `).join('')}
                        </div>

                        <div class="compliance-header">
                            <span class="compliance-icon">üè•</span>
                            <h3>HIPAA Compliance</h3>
                            <span class="compliance-status status-warning">Partial Check</span>
                        </div>
                        <div class="compliance-details">
                            ${Object.entries(hipaaCompliance['HIPAA Requirements']).map(([category, requirements]) => `
                                <h4>${category}</h4>
                                ${Object.entries(requirements).map(([req, check]) => `
                                    <div class="requirement-item requirement-${check.status}">
                                        <strong>${req}:</strong> ${check.details}
                                    </div>
                                `).join('')}
                            `).join('')}
                        </div>

                        <div class="compliance-header">
                            <span class="compliance-icon">üìä</span>
                            <h3>SOC 2 Compliance</h3>
                            <span class="compliance-status status-warning">Partial Check</span>
                        </div>
                        <div class="compliance-details">
                            ${Object.entries(soc2Compliance['SOC 2 Requirements']).map(([category, requirements]) => `
                                <h4>${category}</h4>
                                ${Object.entries(requirements).map(([req, check]) => `
                                    <div class="requirement-item requirement-${check.status}">
                                        <strong>${req}:</strong> ${check.details}
                                    </div>
                                `).join('')}
                            `).join('')}
                        </div>

                        <div class="compliance-header">
                            <span class="compliance-icon">üåê</span>
                            <h3>ISO 27001 Compliance</h3>
                            <span class="compliance-status status-warning">Partial Check</span>
                        </div>
                        <div class="compliance-details">
                            ${Object.entries(iso27001Compliance['ISO 27001 Requirements']).map(([category, requirements]) => `
                                <h4>${category}</h4>
                                ${Object.entries(requirements).map(([req, check]) => `
                                    <div class="requirement-item requirement-${check.status}">
                                        <strong>${req}:</strong> ${check.details}
                                    </div>
                                `).join('')}
                            `).join('')}
                        </div>
                    </div>
                `;

                // Add documentation section
                const documentationSection = `
                    <div class="compliance-section">
                        <h2>Compliance Documentation</h2>
                        ${Object.entries(complianceDocs).map(([standard, docs]) => `
                            <div class="compliance-header">
                                <h3>${standard} Documentation</h3>
                            </div>
                            <div class="compliance-details">
                                <div class="documentation-links">
                                    ${Object.entries(docs).map(([type, url]) => `
                                        <a href="${url}" target="_blank">${type.charAt(0).toUpperCase() + type.slice(1)} Documentation</a><br>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;

                // Update the compliance section to include remediation
                const complianceSection = `
                    <div class="compliance-section">
                        <h2>Compliance Checks</h2>
                        ${Object.entries(pciCompliance['PCI-DSS Requirements']).map(([category, requirements]) => `
                            <div class="compliance-header">
                                <h3>${category}</h3>
                            </div>
                            <div class="compliance-details">
                                ${Object.entries(requirements).map(([req, check]) => `
                                    <div class="requirement-item requirement-${check.status}">
                                        <strong>${req}:</strong> ${check.details}
                                        ${check.remediation ? `
                                            <div class="remediation-guide">
                                                <h5>Remediation Steps:</h5>
                                                <ol class="remediation-steps">
                                                    ${check.remediation.steps.map(step => `<li>${step}</li>`).join('')}
                                                </ol>
                                                <div class="documentation-links">
                                                    ${check.remediation.docs.map(doc => 
                                                        `<a href="${doc.url}" target="_blank">${doc.name}</a><br>`
                                                    ).join('')}
                                                </div>
                                            </div>
                                        ` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        `).join('')}
                    </div>
                    ${documentationSection}
                `;

                securityStatus += complianceSection;
            } catch (error) {
                securityStatus = 'Unable to complete security scan';
            }

            securityScan.innerHTML = securityStatus;
        }

        // Initialize all functions when the page loads
        window.onload = function() {
            getIPAddress();
            getBrowserInfo();
            getGeolocation();
            performSecurityScan();
        };
    </script>
</body>
</html> 